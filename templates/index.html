<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content ="width-device-width,initial scale=1.0">
    <title> Login </title>
    <link rel ="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="login-body">
    <div class="Header">
        <span class="title">
            Finance
        </span>
    </div>
    <div class="wrapper">
        <h1></h1>
        <form action="{{ url_for('login') }}" method="POST">
            <h2>Login</h2>
            <div class="input-box">
                <span class="icon"><ion-icon name="person-outline">
                </ion-icon></span>
                <span class="label">ID</span>
                <input type="text" name="username" placeholder="Jake23" required>
            </div>

            <div class="input-box">
                <span class="icon"><ion-icon name="lock-closed-outline"></ion-icon>
                </span>
                <span class="label">Password</span>
                <input type="password" name="password" placeholder="Password" required>
            </div>
            <button class ="sign-in" type="submit">
                Sign in
            </button>
            <!-- Login flash messages -->
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    <div class="login-flash-messages">
                        {% for category, message in messages %}
                            {% if category == "login-error" %}
                                <p>{{ message }}</p>
                            {% endif %}
                        {% endfor %}
                    </div>
                {% endif %}
            {% endwith %}
            <div class="register-link">
                <p>Start analysing.
                    <a href="#">
                    Register</a>
                </p>
            </div>
        </form>
        <!-- Register Modal -->
        <div id="registerModal" class="modal">
            <div class="modal-content">
                <span class="close-btn">&times;</span>
                <h2>Register</h2>
                <!-- flash for registration success or failure -->
                {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        <div class="flash-messages">
                            {% for category, message in messages %}
                            <p class ={{category}}>{{ message }}</p>
                        {% endfor %}
                        </div>
                    {% endif %}
                {% endwith %}
                <form action="{{ url_for('register') }}" method="POST">
                    <div class="register-box">
                        <input type="text" name="username" placeholder="Username" required>
                    </div>
                    <div class="register-box">
                        <input type="password" name="password" placeholder="Password" required>
                    </div>
                    <button class= "submit-register" type="submit">Register</button>
                </form>
            </div>
        </div>
    </div>

    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    <script src="{{ url_for('static', filename='script-index.js') }}"></script>
</body>
</html>

<script>
  {% if request.args.get('show_register') %}
    document.addEventListener("DOMContentLoaded", function() {
        document.getElementById("registerModal").style.display = "block";
    });
  {% endif %}
</script>
